<div id="cybersecurity-goal-page" style="padding-top:4em">
    <table mat-table [dataSource]="dataSourceControl" class="cybersecurity-page-table" *ngIf="dataSourceControl.data?.length > 0; else emptycontrols">
        <ng-container matColumnDef="no">
            <th mat-header-cell *matHeaderCellDef> No </th>
            <td mat-cell *matCellDef="let element"> CTR{{element.rowNumber}} </td>
        </ng-container>

        <ng-container matColumnDef="control">
            <th mat-header-cell *matHeaderCellDef> Control </th>
            <td mat-cell *matCellDef="let element">
                <mat-form-field appearance="none">
                    <textarea matInput [readonly]="true" class="cybersecurity-page-content" cdkTextareaAutosize
                      [ngModel]="element.content"  #autosize="cdkTextareaAutosize" cdkAutosizeMinRows="3" cdkAutosizeMaxRows="3"></textarea>
                </mat-form-field>
            </td>
        </ng-container>

        <ng-container matColumnDef="action">
            <th mat-header-cell *matHeaderCellDef></th>
            <td mat-cell *matCellDef="let element; let i = index">
                <button [disabled]="_editDesignShared.projectStatus?.milestoneView" mat-raised-button [matMenuTriggerFor]="goalaction"
                    [matMenuTriggerData]="{element: element, index: i}"
                    >
                    <mat-icon aria-hidden="false" aria-label="Loading Icon">more_horiz
                    </mat-icon>
                </button>
            </td>
        </ng-container>
        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;" class="cybersecurity-goal-row"></tr>
    </table>

    <mat-menu #goalaction="matMenu" class="goalLibDropdown">
        <ng-template matMenuContent let-selectedControl="element" let-index="index">
            <button mat-menu-item (click)="addControl()">
                <mat-icon aria-hidden="false" aria-label="Add Icon">add</mat-icon> Add Control
            </button>
            <button mat-menu-item (click)="addControl(selectedControl)">
                <mat-icon aria-hidden="false" aria-label="Add Icon">edit</mat-icon> Update Control
            </button>
            <button mat-menu-item (click)="addControlToLibrary(selectedControl)">
                <mat-icon aria-hidden="false" aria-label="Add Icon">add</mat-icon> Add Control to Library
            </button>
            <button mat-menu-item (click)="removeControl(selectedControl)">
                <mat-icon aria-hidden="false" aria-label="Remove Icon">remove
                </mat-icon> Delete Control
            </button>
        </ng-template>
    </mat-menu>

    <ng-template #emptycontrols>
        <ng-container *ngIf="!controlLoading">
            <p>No cybersecurity control found</p>
            <button mat-raised-button [disabled]="_editDesignShared.projectStatus?.milestoneView" color="primary" style="width:14em;" (click)="addControl()">
                <mat-icon aria-hidden="false" aria-label="Add Icon">add</mat-icon> Add Control
            </button>
        </ng-container>
    </ng-template>
</div>