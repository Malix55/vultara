<div style="position: relative;top: 50px;">

    <mat-tab-group (selectedTabChange)="settingsTabClick($event)">
        <mat-tab label="Active List">
            <ng-template matTabContent>

                <div class="weakness-table-view-container">
                    <div id="weakness-table-view">
                        <div class="weakness-list-filter">
                            <mat-form-field id="weakness-filter-section" style="text-align:left">
                                <mat-label>Search</mat-label>
                                <input matInput (input)="search($event)" placeholder="Search" #searchInput>
                            </mat-form-field>
                            <button id="refresh-weakness-list" mat-raised-button (click)="refreshTable()"
                                color="gray">
                                Refresh
                            </button>
                        </div>
                        <div class="weakness-list-table-container" id="myId">
                            <table mat-table [dataSource]="dataSource" matSort multiTemplateDataRows>
                                <ng-container matColumnDef="weaknessNumber">
                                    <th mat-header-cell *matHeaderCellDef> Weakness No </th>
                                    <td mat-cell *matCellDef="let row">
                                        {{row.weaknessNumber}}
                                    </td>
                                </ng-container>
                                <ng-container matColumnDef="dateIdentified">
                                    <th mat-header-cell *matHeaderCellDef> Date Identified </th>
                                    <td mat-cell *matCellDef="let row; let i = renderIndex;">
                                        {{row.dateIdentified|date:'yyyy/MM/dd'}}
                                    </td>
                                </ng-container>
                                <ng-container matColumnDef="identificationMethod">
                                    <th mat-header-cell *matHeaderCellDef> Identification Method (Source) </th>
                                    <td mat-cell *matCellDef="let row; let i = renderIndex;">
                                        <!-- <ng-container> -->
                                        <mat-form-field appearance="none">
                                            <textarea matInput placeholder="Id Method"
                                                [(ngModel)]="row.identificationMethod" [readonly]="true"
                                                cdkTextareaAutosize #autosize="cdkTextareaAutosize"
                                                cdkAutosizeMinRows="1" cdkAutosizeMaxRows="5"></textarea>
                                        </mat-form-field>
                                        <!-- <mat-button-toggle-group class="swhw" (change)="swhwChanged($event, row)" *ngIf="row.vulnerabilitySource =='userManual'" name="swhw" aria-label="swhw">
                  <mat-button-toggle checked="true" value="sw">SW</mat-button-toggle>
                  <mat-button-toggle value="hw">HW</mat-button-toggle>
                </mat-button-toggle-group> -->
                                    </td>
                                </ng-container>
                                <ng-container matColumnDef="sourceNotes">
                                    <th mat-header-cell *matHeaderCellDef> Source Notes </th>
                                    <td mat-cell *matCellDef="let row; let i = renderIndex;"
                                        (click)="$event.stopPropagation()">
                                        <ng-container *ngIf="row.sourceLink;else noLink">
                                            <a [href]="row.sourceLink" target="_blank">{{row.sourceNotes}}</a>
                                        </ng-container>
                                        <ng-template #noLink>
                                            {{row.sourceNotes}}
                                        </ng-template>
                                    </td>
                                </ng-container>
                                <ng-container matColumnDef="component">
                                    <th mat-header-cell *matHeaderCellDef> Component </th>
                                    <td mat-cell *matCellDef="let row; let i = renderIndex;">
                                        {{row.component}}
                                    </td>
                                </ng-container>
                                <ng-container matColumnDef="attackSurface">
                                    <th mat-header-cell *matHeaderCellDef> Attack Surface(s) </th>
                                    <td mat-cell *matCellDef="let row; let i = renderIndex;">
                                        {{row.attackSurface}}
                                    </td>
                                </ng-container>
                                <ng-container matColumnDef="asset">
                                    <th mat-header-cell *matHeaderCellDef> Asset(s) </th>
                                    <td mat-cell *matCellDef="let row; let i = renderIndex;">
                                        {{row.asset}}
                                    </td>
                                </ng-container>
                                <ng-container matColumnDef="weaknessDescription">
                                    <th mat-header-cell *matHeaderCellDef> Weakness Description </th>
                                    <td mat-cell *matCellDef="let row; let i = renderIndex">
                                        <textarea class="weakness-description" matInput inputchange
                                            placeholder="Description" [(ngModel)]="row.weaknessDescription"
                                            [readonly]="true"></textarea>
                                    </td>
                                </ng-container>
                                <ng-container matColumnDef="cweId">
                                    <th mat-header-cell *matHeaderCellDef> CWE ID </th>
                                    <td mat-cell *matCellDef="let row" (click)="$event.stopPropagation()">
                                        <a href="{{'https://cwe.mitre.org/data/definitions/'+row.cweId+'.html'}}"
                                            target="_blank">{{row.cweId !==null?'CWE-'+row.cweId:''}}</a>
                                    </td>
                                </ng-container>
                                <ng-container matColumnDef="cweWeaknessType">
                                    <th mat-header-cell *matHeaderCellDef> CWE Weakness Type </th>
                                    <td mat-cell *matCellDef="let row; let i = renderIndex">
                                        {{row.cweWeaknessType}}
                                    </td>
                                </ng-container>
                                <ng-container matColumnDef="cweCategory">
                                    <th mat-header-cell *matHeaderCellDef>CWE Category</th>
                                    <td mat-cell *matCellDef="let row; let i = renderIndex">
                                        {{row.cweWeaknessCategory}}
                                    </td>
                                </ng-container>
                                <ng-container matColumnDef="vulnerabilityAnalysis">
                                    <th mat-header-cell *matHeaderCellDef> Vulnerability Analysis </th>
                                    <td mat-cell *matCellDef="let row; let i = renderIndex"
                                        (click)="$event.stopPropagation()">
                                        <div class="oval" [ngClass]="row.vulnerabilityAnalysis|analysisColor"
                                            (click)="editAnalysis(row,'updated')">
                                            {{row.vulnerabilityAnalysis}}
                                        </div>
                                    </td>
                                </ng-container>
                                <ng-container matColumnDef="vulnerabilitiesLinked">
                                    <th mat-header-cell *matHeaderCellDef>Vulnerabilities Linked</th>
                                    <td mat-cell *matCellDef="let row; let i = renderIndex">
                                        {{row?.linkedVulnerabilities?.length}}
                                    </td>
                                </ng-container>
                                <ng-container matColumnDef="tableOp">
                                    <th mat-header-cell *matHeaderCellDef></th>
                                    <td mat-cell *matCellDef="let row; let i = index"
                                        (click)="$event.stopPropagation()">
                                        <button [disabled]="editDesignShared.projectStatus?.milestoneView"
                                            mat-raised-button [matMenuTriggerFor]="threatBtnMenu">
                                            <mat-icon>more_horiz</mat-icon>
                                        </button>
                                        <mat-menu #threatBtnMenu="matMenu">
                                            <button mat-menu-item (click)="deleteRow(row)" [disabled]="row.reviewed">
                                                <mat-icon>remove</mat-icon>
                                                Delete Weakness
                                            </button>
                                            <button mat-menu-item (click)="addWeakness()">
                                                <mat-icon>add</mat-icon>
                                                Add New Weakness
                                            </button>
                                            <button
                                                *ngIf="row.vulnerabilityAnalysis=='Completed'&&row.exploitable=='Yes'"
                                                mat-menu-item (click)="linkedVulnerabilities(row)">
                                                <mat-icon>link</mat-icon>
                                                Link Vulnerabilities
                                            </button>
                                            <button mat-menu-item (click)="toggleHighlight(row)">
                                                <mat-icon>help_outline</mat-icon>
                                                {{ row.highlighted ? "Remove Highlight" : "Highlight" }}
                                            </button>
                                        </mat-menu>
                                    </td>
                                </ng-container>
                                <tr mat-header-row *matHeaderRowDef="displayedColumns; sticky: true"></tr>
                                <tr mat-row *matRowDef="let row; let i=index; columns: displayedColumns;"
                                    class="threat-row" [style.background-color]="row|rowColor" [id]="row._id"
                                    (click)="addWeakness(row)">
                                </tr>
                            </table>
                            <mat-paginator [length]="dataSource.data.length" [pageSizeOptions]="[10, 20, 50]"
                                showFirstLastButtons></mat-paginator>
                        </div>
                    </div>
                </div>
                <button [disabled]="editDesignShared.projectStatus?.milestoneView" *ngIf="dataSource.data.length == 0"
                    class="add-new-btn" mat-raised-button (click)="addWeakness()">+ Add New Weakness</button>
                <ngx-spinner name="vulnerability-spinner"></ngx-spinner>
                <!-- <div class="notifications-details-actions" *ngIf="!loadingDoneV">
  <button mat-raised-button color="primary" (click)="loadMoreV()">Load More</button>
</div>  -->

            </ng-template>
        </mat-tab>
        <mat-tab label="Archived List">
            <ng-template matTabContent>

                <div class="weakness-table-view-container">
                    <div id="weakness-table-view">
                        <div class="weakness-list-filter">
                            <mat-form-field id="weakness-filter-section" style="text-align:left">
                                <mat-label>Search</mat-label>
                                <input matInput (input)="search($event)" placeholder="Search" #searchInput>
                            </mat-form-field>
                            <button id="refresh-weakness-list" mat-raised-button (click)="refreshTable()"
                                color="gray">
                                Refresh
                            </button>
                        </div>
                        <div class="weakness-list-table-container" id="myId">
                            <table mat-table [dataSource]="archivedDataSource" matSort multiTemplateDataRows>
                                <ng-container matColumnDef="weaknessNumber">
                                    <th mat-header-cell *matHeaderCellDef> Weakness No </th>
                                    <td mat-cell *matCellDef="let row">
                                        {{row.weaknessNumber}}
                                    </td>
                                </ng-container>
                                <ng-container matColumnDef="dateIdentified">
                                    <th mat-header-cell *matHeaderCellDef> Date Identified </th>
                                    <td mat-cell *matCellDef="let row; let i = renderIndex;">
                                        {{row.dateIdentified|date:'yyyy/MM/dd'}}
                                    </td>
                                </ng-container>
                                <ng-container matColumnDef="identificationMethod">
                                    <th mat-header-cell *matHeaderCellDef> Identification Method (Source) </th>
                                    <td mat-cell *matCellDef="let row; let i = renderIndex;">
                                        <!-- <ng-container> -->
                                        <mat-form-field appearance="none">
                                            <textarea matInput placeholder="Id Method"
                                                [(ngModel)]="row.identificationMethod" [readonly]="true"
                                                cdkTextareaAutosize #autosize="cdkTextareaAutosize"
                                                cdkAutosizeMinRows="1" cdkAutosizeMaxRows="5"></textarea>
                                        </mat-form-field>
                                        <!-- <mat-button-toggle-group class="swhw" (change)="swhwChanged($event, row)" *ngIf="row.vulnerabilitySource =='userManual'" name="swhw" aria-label="swhw">
                  <mat-button-toggle checked="true" value="sw">SW</mat-button-toggle>
                  <mat-button-toggle value="hw">HW</mat-button-toggle>
                </mat-button-toggle-group> -->
                                    </td>
                                </ng-container>
                                <ng-container matColumnDef="sourceNotes">
                                    <th mat-header-cell *matHeaderCellDef> Source Notes </th>
                                    <td mat-cell *matCellDef="let row; let i = renderIndex;"
                                        (click)="$event.stopPropagation()">
                                        {{row.sourceNotes}}
                                    </td>
                                </ng-container>
                                <ng-container matColumnDef="component">
                                    <th mat-header-cell *matHeaderCellDef> Component </th>
                                    <td mat-cell *matCellDef="let row; let i = renderIndex;">
                                        {{row.component}}
                                    </td>
                                </ng-container>
                                <ng-container matColumnDef="attackSurface">
                                    <th mat-header-cell *matHeaderCellDef> Attack Surface(s) </th>
                                    <td mat-cell *matCellDef="let row; let i = renderIndex;">
                                        {{row.attackSurface}}
                                    </td>
                                </ng-container>
                                <ng-container matColumnDef="asset">
                                    <th mat-header-cell *matHeaderCellDef> Asset(s) </th>
                                    <td mat-cell *matCellDef="let row; let i = renderIndex;">
                                        {{row.asset}}
                                    </td>
                                </ng-container>
                                <ng-container matColumnDef="weaknessDescription">
                                    <th mat-header-cell *matHeaderCellDef> Weakness Description </th>
                                    <td mat-cell *matCellDef="let row; let i = renderIndex">
                                        <textarea class="weakness-description" matInput inputchange
                                            placeholder="Description" [(ngModel)]="row.weaknessDescription"
                                            [readonly]="true"></textarea>
                                    </td>
                                </ng-container>
                                <ng-container matColumnDef="cweId">
                                    <th mat-header-cell *matHeaderCellDef> CWE ID </th>
                                    <td mat-cell *matCellDef="let row">
                                        <a href="{{'https://cwe.mitre.org/data/definitions/'+row.cweId+'.html'}}"
                                            target="_blank">{{row.cweId?'CWE-'+row.cweId:''}}</a>
                                    </td>
                                </ng-container>
                                <ng-container matColumnDef="cweWeaknessType">
                                    <th mat-header-cell *matHeaderCellDef> CWE Weakness Type </th>
                                    <td mat-cell *matCellDef="let row; let i = renderIndex">
                                        {{row.cweWeaknessType}}
                                    </td>
                                </ng-container>
                                <ng-container matColumnDef="cweCategory">
                                    <th mat-header-cell *matHeaderCellDef>CWE Category</th>
                                    <td mat-cell *matCellDef="let row; let i = renderIndex">
                                        {{row.cweWeaknessCategory}}
                                    </td>
                                </ng-container>
                                <ng-container matColumnDef="vulnerabilityAnalysis">
                                    <th mat-header-cell *matHeaderCellDef> Vulnerability Analysis </th>
                                    <td mat-cell *matCellDef="let row; let i = renderIndex"
                                        (click)="$event.stopPropagation()">
                                        <div class="oval" [ngClass]="row.vulnerabilityAnalysis|analysisColor"
                                            (click)="editAnalysis(row,'updated')">
                                            {{row.vulnerabilityAnalysis}}
                                        </div>
                                    </td>
                                </ng-container>
                                <ng-container matColumnDef="vulnerabilitiesLinked">
                                    <th mat-header-cell *matHeaderCellDef>Vulnerabilities Linked</th>
                                    <td mat-cell *matCellDef="let row; let i = renderIndex">
                                        N/A
                                    </td>
                                </ng-container>
                                <ng-container matColumnDef="tableOp">
                                    <th mat-header-cell *matHeaderCellDef></th>
                                    <td mat-cell *matCellDef="let row; let i = index"
                                        (click)="$event.stopPropagation()">
                                        <button [disabled]="editDesignShared.projectStatus?.milestoneView"
                                            mat-raised-button [matMenuTriggerFor]="threatBtnMenu">
                                            <mat-icon>more_horiz</mat-icon>
                                        </button>
                                        <mat-menu #threatBtnMenu="matMenu">
                                            <button mat-menu-item (click)="deleteRow(row)" [disabled]="row.reviewed">
                                                <mat-icon>remove</mat-icon>
                                                Delete Weakness
                                            </button>
                                            <button mat-menu-item (click)="toggleHighlight(row)">
                                                <mat-icon>help_outline</mat-icon>
                                                {{ row.highlighted ? "Remove Highlight" : "Highlight" }}
                                            </button>
                                        </mat-menu>
                                    </td>
                                </ng-container>
                                <tr mat-header-row *matHeaderRowDef="displayedColumns; sticky: true"></tr>
                                <tr mat-row *matRowDef="let row; let i=index; columns: displayedColumns;"
                                    class="threat-row" [style.background-color]="row|rowColor" [id]="row._id"
                                    (click)="addWeakness(row)">
                                </tr>
                            </table>
                            <mat-paginator [length]="archivedDataSource.data.length" [pageSizeOptions]="[10, 20, 50]"
                                showFirstLastButtons></mat-paginator>
                        </div>
                    </div>
                </div>
                <ngx-spinner name="vulnerability-spinner"></ngx-spinner>
                <!-- <div class="notifications-details-actions" *ngIf="!loadingDoneV">
  <button mat-raised-button color="primary" (click)="loadMoreV()">Load More</button>
</div>  -->
            </ng-template>
        </mat-tab>
    </mat-tab-group>

</div>